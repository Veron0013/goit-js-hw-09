var K=Object.defineProperty,U=(d,t,i)=>t in d?K(d,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):d[t]=i,O=(d,t,i)=>(U(d,typeof t!="symbol"?t+"":t,i),i);const Q=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,J=/^-?[0-9]\d*$/,R=/^(?=.*[A-Za-z])(?=.*\d).{8,}$/,ee=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/,te=d=>{let t=d;return typeof d=="string"&&(t=d.trim()),!t},oe=d=>Q.test(d),ie=(d,t)=>d.length>t,se=(d,t)=>d.length<t,re=d=>typeof d!="string"?!1:!isNaN(+d)&&!isNaN(parseFloat(d)),ne=d=>J.test(d),ae=d=>R.test(d),le=d=>ee.test(d),de=(d,t)=>d>t,ce=(d,t)=>d<t,T=d=>typeof d!="string"||d==="";var S=(d=>(d.Required="required",d.Email="email",d.MinLength="minLength",d.MaxLength="maxLength",d.Password="password",d.Number="number",d.Integer="integer",d.MaxNumber="maxNumber",d.MinNumber="minNumber",d.StrongPassword="strongPassword",d.CustomRegexp="customRegexp",d.MinFilesCount="minFilesCount",d.MaxFilesCount="maxFilesCount",d.Files="files",d))(S||{}),z=(d=>(d.Required="required",d))(z||{}),B=(d=>(d.Label="label",d.LabelArrow="labelArrow",d))(B||{});const G=[{key:S.Required,dict:{en:"The field is required"}},{key:S.Email,dict:{en:"Email has invalid format"}},{key:S.MaxLength,dict:{en:"The field must contain a maximum of :value characters"}},{key:S.MinLength,dict:{en:"The field must contain a minimum of :value characters"}},{key:S.Password,dict:{en:"Password must contain minimum eight characters, at least one letter and one number"}},{key:S.StrongPassword,dict:{en:"Password should contain minimum eight characters, at least one uppercase letter, one lowercase letter, one number and one special character"}},{key:S.Number,dict:{en:"Value should be a number"}},{key:S.MaxNumber,dict:{en:"Number should be less or equal than :value"}},{key:S.MinNumber,dict:{en:"Number should be more or equal than :value"}},{key:S.MinFilesCount,dict:{en:"Files count should be more or equal than :value"}},{key:S.MaxFilesCount,dict:{en:"Files count should be less or equal than :value"}},{key:S.Files,dict:{en:"Uploaded files have one or several invalid properties (extension/size/type etc)."}}],fe="Value is incorrect",X=d=>typeof d=="object"&&d!==null&&"then"in d&&typeof d.then=="function",he=d=>{let t=d;const i=[];for(;t;)i.unshift(t),t=t.parentNode;return i},ue=(d,t)=>{const i=[...t].reverse();for(let s=0,n=i.length;s<n;++s){const l=i[s];for(const a in d){const h=d[a];if(h.groupElem===l)return[a,h]}}return null},x=d=>Array.isArray(d)?d.filter(t=>t.length>0):typeof d=="string"&&d.trim()?[...d.split(" ").filter(t=>t.length>0)]:[],H=d=>d instanceof Element||d instanceof HTMLDocument,pe=".just-validate-error-label[data-tooltip=true]{position:fixed;padding:4px 8px;background:#423f3f;color:#fff;white-space:nowrap;z-index:10;border-radius:4px;transform:translateY(-5px)}.just-validate-error-label[data-tooltip=true]:before{content:'';width:0;height:0;border-left:solid 5px transparent;border-right:solid 5px transparent;border-bottom:solid 5px #423f3f;position:absolute;z-index:3;display:block;bottom:-5px;transform:rotate(180deg);left:calc(50% - 5px)}.just-validate-error-label[data-tooltip=true][data-direction=left]{transform:translateX(-5px)}.just-validate-error-label[data-tooltip=true][data-direction=left]:before{right:-7px;bottom:auto;left:auto;top:calc(50% - 2px);transform:rotate(90deg)}.just-validate-error-label[data-tooltip=true][data-direction=right]{transform:translateX(5px)}.just-validate-error-label[data-tooltip=true][data-direction=right]:before{right:auto;bottom:auto;left:-7px;top:calc(50% - 2px);transform:rotate(-90deg)}.just-validate-error-label[data-tooltip=true][data-direction=bottom]{transform:translateY(5px)}.just-validate-error-label[data-tooltip=true][data-direction=bottom]:before{right:auto;bottom:auto;left:calc(50% - 5px);top:-5px;transform:rotate(0)}",j=5,$={errorFieldStyle:{color:"#b81111",border:"1px solid #B81111"},errorFieldCssClass:"just-validate-error-field",successFieldCssClass:"just-validate-success-field",errorLabelStyle:{color:"#b81111"},errorLabelCssClass:"just-validate-error-label",successLabelCssClass:"just-validate-success-label",focusInvalidField:!0,lockForm:!0,testingMode:!1,validateBeforeSubmitting:!1,submitFormAutomatically:!1};class ve{constructor(t,i,s){O(this,"form",null),O(this,"fields",{}),O(this,"groupFields",{}),O(this,"errors",{}),O(this,"isValid",!1),O(this,"isSubmitted",!1),O(this,"globalConfig",$),O(this,"errorLabels",{}),O(this,"successLabels",{}),O(this,"eventListeners",[]),O(this,"dictLocale",G),O(this,"currentLocale","en"),O(this,"customStyleTags",{}),O(this,"onSuccessCallback"),O(this,"onFailCallback"),O(this,"onValidateCallback"),O(this,"tooltips",[]),O(this,"lastScrollPosition"),O(this,"isScrollTick"),O(this,"fieldIds",new Map),O(this,"getKeyByFieldSelector",n=>this.fieldIds.get(n)),O(this,"getFieldSelectorByKey",n=>{for(const[l,a]of this.fieldIds)if(n===a)return l}),O(this,"getCompatibleFields",()=>{const n={};return Object.keys(this.fields).forEach(l=>{let a=l;const h=this.getFieldSelectorByKey(l);typeof h=="string"&&(a=h),n[a]={...this.fields[l]}}),n}),O(this,"setKeyByFieldSelector",n=>{if(this.fieldIds.has(n))return this.fieldIds.get(n);const l=String(this.fieldIds.size+1);return this.fieldIds.set(n,l),l}),O(this,"refreshAllTooltips",()=>{this.tooltips.forEach(n=>{n.refresh()})}),O(this,"handleDocumentScroll",()=>{this.lastScrollPosition=window.scrollY,this.isScrollTick||(window.requestAnimationFrame(()=>{this.refreshAllTooltips(),this.isScrollTick=!1}),this.isScrollTick=!0)}),O(this,"formSubmitHandler",n=>{n.preventDefault(),this.isSubmitted=!0,this.validateHandler(n)}),O(this,"handleFieldChange",n=>{let l;for(const a in this.fields)if(this.fields[a].elem===n){l=a;break}l&&(this.fields[l].touched=!0,this.validateField(l,!0))}),O(this,"handleGroupChange",n=>{let l;for(const a in this.groupFields)if(this.groupFields[a].elems.find(w=>w===n)){l=a;break}l&&(this.groupFields[l].touched=!0,this.validateGroup(l,!0))}),O(this,"handlerChange",n=>{n.target&&(this.handleFieldChange(n.target),this.handleGroupChange(n.target),this.renderErrors())}),this.initialize(t,i,s)}initialize(t,i,s){if(this.form=null,this.errors={},this.isValid=!1,this.isSubmitted=!1,this.globalConfig=$,this.errorLabels={},this.successLabels={},this.eventListeners=[],this.customStyleTags={},this.tooltips=[],this.currentLocale="en",typeof t=="string"){const n=document.querySelector(t);if(!n)throw Error(`Form with ${t} selector not found! Please check the form selector`);this.setForm(n)}else if(t instanceof HTMLFormElement)this.setForm(t);else throw Error("Form selector is not valid. Please specify a string selector or a DOM element.");if(this.globalConfig={...$,...i},s&&(this.dictLocale=[...s,...G]),this.isTooltip()){const n=document.createElement("style");n.textContent=pe,this.customStyleTags[B.Label]=document.head.appendChild(n),this.addListener("scroll",document,this.handleDocumentScroll)}}getLocalisedString(t,i,s){var n;const l=s??t;let a=(n=this.dictLocale.find(h=>h.key===l))==null?void 0:n.dict[this.currentLocale];if(a||s&&(a=s),a&&i!==void 0)switch(t){case S.MaxLength:case S.MinLength:case S.MaxNumber:case S.MinNumber:case S.MinFilesCount:case S.MaxFilesCount:a=a.replace(":value",String(i))}return a||s||fe}getFieldErrorMessage(t,i){const s=typeof t.errorMessage=="function"?t.errorMessage(this.getElemValue(i),this.fields):t.errorMessage;return this.getLocalisedString(t.rule,t.value,s)}getFieldSuccessMessage(t,i){const s=typeof t=="function"?t(this.getElemValue(i),this.fields):t;return this.getLocalisedString(void 0,void 0,s)}getGroupErrorMessage(t){return this.getLocalisedString(t.rule,void 0,t.errorMessage)}getGroupSuccessMessage(t){if(t.successMessage)return this.getLocalisedString(void 0,void 0,t.successMessage)}setFieldInvalid(t,i){this.fields[t].isValid=!1,this.fields[t].errorMessage=this.getFieldErrorMessage(i,this.fields[t].elem)}setFieldValid(t,i){this.fields[t].isValid=!0,i!==void 0&&(this.fields[t].successMessage=this.getFieldSuccessMessage(i,this.fields[t].elem))}setGroupInvalid(t,i){this.groupFields[t].isValid=!1,this.groupFields[t].errorMessage=this.getGroupErrorMessage(i)}setGroupValid(t,i){this.groupFields[t].isValid=!0,this.groupFields[t].successMessage=this.getGroupSuccessMessage(i)}getElemValue(t){switch(t.type){case"checkbox":return t.checked;case"file":return t.files;default:return t.value}}validateGroupRule(t,i,s){switch(s.rule){case z.Required:i.every(n=>!n.checked)?this.setGroupInvalid(t,s):this.setGroupValid(t,s)}}validateFieldRule(t,i,s,n=!1){const l=s.value,a=this.getElemValue(i);if(s.plugin){s.plugin(a,this.getCompatibleFields())||this.setFieldInvalid(t,s);return}switch(s.rule){case S.Required:{te(a)&&this.setFieldInvalid(t,s);break}case S.Email:{if(T(a))break;oe(a)||this.setFieldInvalid(t,s);break}case S.MaxLength:{if(l===void 0){console.error(`Value for ${s.rule} rule for [${t}] field is not defined. The field will be always invalid.`),this.setFieldInvalid(t,s);break}if(typeof l!="number"){console.error(`Value for ${s.rule} rule for [${t}] should be a number. The field will be always invalid.`),this.setFieldInvalid(t,s);break}if(T(a))break;ie(a,l)&&this.setFieldInvalid(t,s);break}case S.MinLength:{if(l===void 0){console.error(`Value for ${s.rule} rule for [${t}] field is not defined. The field will be always invalid.`),this.setFieldInvalid(t,s);break}if(typeof l!="number"){console.error(`Value for ${s.rule} rule for [${t}] should be a number. The field will be always invalid.`),this.setFieldInvalid(t,s);break}if(T(a))break;se(a,l)&&this.setFieldInvalid(t,s);break}case S.Password:{if(T(a))break;ae(a)||this.setFieldInvalid(t,s);break}case S.StrongPassword:{if(T(a))break;le(a)||this.setFieldInvalid(t,s);break}case S.Number:{if(T(a))break;re(a)||this.setFieldInvalid(t,s);break}case S.Integer:{if(T(a))break;ne(a)||this.setFieldInvalid(t,s);break}case S.MaxNumber:{if(l===void 0){console.error(`Value for ${s.rule} rule for [${t}] field is not defined. The field will be always invalid.`),this.setFieldInvalid(t,s);break}if(typeof l!="number"){console.error(`Value for ${s.rule} rule for [${t}] field should be a number. The field will be always invalid.`),this.setFieldInvalid(t,s);break}if(T(a))break;const h=+a;(Number.isNaN(h)||de(h,l))&&this.setFieldInvalid(t,s);break}case S.MinNumber:{if(l===void 0){console.error(`Value for ${s.rule} rule for [${t}] field is not defined. The field will be always invalid.`),this.setFieldInvalid(t,s);break}if(typeof l!="number"){console.error(`Value for ${s.rule} rule for [${t}] field should be a number. The field will be always invalid.`),this.setFieldInvalid(t,s);break}if(T(a))break;const h=+a;(Number.isNaN(h)||ce(h,l))&&this.setFieldInvalid(t,s);break}case S.CustomRegexp:{if(l===void 0){console.error(`Value for ${s.rule} rule for [${t}] field is not defined. This field will be always invalid.`),this.setFieldInvalid(t,s);return}let h;try{h=new RegExp(l)}catch{console.error(`Value for ${s.rule} rule for [${t}] should be a valid regexp. This field will be always invalid.`),this.setFieldInvalid(t,s);break}const w=String(a);w!==""&&!h.test(w)&&this.setFieldInvalid(t,s);break}case S.MinFilesCount:{if(l===void 0){console.error(`Value for ${s.rule} rule for [${t}] field is not defined. This field will be always invalid.`),this.setFieldInvalid(t,s);break}if(typeof l!="number"){console.error(`Value for ${s.rule} rule for [${t}] field should be a number. The field will be always invalid.`),this.setFieldInvalid(t,s);break}if(Number.isFinite(a==null?void 0:a.length)&&a.length<l){this.setFieldInvalid(t,s);break}break}case S.MaxFilesCount:{if(l===void 0){console.error(`Value for ${s.rule} rule for [${t}] field is not defined. This field will be always invalid.`),this.setFieldInvalid(t,s);break}if(typeof l!="number"){console.error(`Value for ${s.rule} rule for [${t}] field should be a number. The field will be always invalid.`),this.setFieldInvalid(t,s);break}if(Number.isFinite(a==null?void 0:a.length)&&a.length>l){this.setFieldInvalid(t,s);break}break}case S.Files:{if(l===void 0){console.error(`Value for ${s.rule} rule for [${t}] field is not defined. This field will be always invalid.`),this.setFieldInvalid(t,s);return}if(typeof l!="object"){console.error(`Value for ${s.rule} rule for [${t}] field should be an object. This field will be always invalid.`),this.setFieldInvalid(t,s);return}const h=l.files;if(typeof h!="object"){console.error(`Value for ${s.rule} rule for [${t}] field should be an object with files array. This field will be always invalid.`),this.setFieldInvalid(t,s);return}const w=(v,C)=>{const I=Number.isFinite(C.minSize)&&v.size<C.minSize,y=Number.isFinite(C.maxSize)&&v.size>C.maxSize,V=Array.isArray(C.names)&&!C.names.includes(v.name),_=Array.isArray(C.extensions)&&!C.extensions.includes(v.name.split(".")[v.name.split(".").length-1]),m=Array.isArray(C.types)&&!C.types.includes(v.type);return I||y||V||_||m};if(typeof a=="object"&&a!==null)for(let v=0,C=a.length;v<C;++v){const I=a.item(v);if(!I){this.setFieldInvalid(t,s);break}if(w(I,h)){this.setFieldInvalid(t,s);break}}break}default:{if(typeof s.validator!="function"){console.error(`Validator for custom rule for [${t}] field should be a function. This field will be always invalid.`),this.setFieldInvalid(t,s);return}const h=s.validator(a,this.getCompatibleFields());if(typeof h!="boolean"&&typeof h!="function"&&console.error(`Validator return value for [${t}] field should be boolean or function. It will be cast to boolean.`),typeof h=="function")if(n)this.fields[t].asyncCheckPending=!0;else{this.fields[t].asyncCheckPending=!1;const w=h();if(!X(w)){console.error(`Validator function for custom rule for [${t}] field should return a Promise. This field will be always invalid.`),this.setFieldInvalid(t,s);return}return w.then(v=>{v||this.setFieldInvalid(t,s)}).catch(()=>{this.setFieldInvalid(t,s)})}h||this.setFieldInvalid(t,s)}}}isFormValid(){let t=!0;for(let i=0,s=Object.values(this.fields).length;i<s;++i){const n=Object.values(this.fields)[i];if(n.isValid===void 0){t=void 0;break}if(n.isValid===!1){t=!1;break}}for(let i=0,s=Object.values(this.groupFields).length;i<s;++i){const n=Object.values(this.groupFields)[i];if(n.isValid===void 0){t=void 0;break}if(n.isValid===!1){t=!1;break}}return t}validateField(t,i=!1){var s;const n=this.fields[t];n.isValid=!0;const l=[];return[...n.rules].reverse().forEach(a=>{const h=this.validateFieldRule(t,n.elem,a,i);X(h)&&l.push(h)}),n.isValid&&this.setFieldValid(t,(s=n.config)==null?void 0:s.successMessage),Promise.allSettled(l).finally(()=>{var a;i&&((a=this.onValidateCallback)==null||a.call(this,{isValid:this.isFormValid(),isSubmitted:this.isSubmitted,fields:this.getCompatibleFields(),groups:{...this.groupFields}}))})}revalidateField(t){if(typeof t!="string"&&!H(t))throw Error("Field selector is not valid. Please specify a string selector or a valid DOM element.");const i=this.getKeyByFieldSelector(t);return!i||!this.fields[i]?(console.error("Field not found. Check the field selector."),Promise.reject()):new Promise(s=>{this.validateField(i,!0).finally(()=>{this.clearFieldStyle(i),this.clearFieldLabel(i),this.renderFieldError(i,!0),s(!!this.fields[i].isValid)})})}revalidateGroup(t){if(typeof t!="string"&&!H(t))throw Error("Group selector is not valid. Please specify a string selector or a valid DOM element.");const i=this.getKeyByFieldSelector(t);return!i||!this.groupFields[i]?(console.error("Group not found. Check the group selector."),Promise.reject()):new Promise(s=>{this.validateGroup(i).finally(()=>{this.clearFieldLabel(i),this.renderGroupError(i,!0),s(!!this.groupFields[i].isValid)})})}validateGroup(t,i=!1){const s=this.groupFields[t],n=[];return[...s.rules].reverse().forEach(l=>{const a=this.validateGroupRule(t,s.elems,l);X(a)&&n.push(a)}),Promise.allSettled(n).finally(()=>{var l;i&&((l=this.onValidateCallback)==null||l.call(this,{isValid:this.isFormValid(),isSubmitted:this.isSubmitted,fields:this.getCompatibleFields(),groups:{...this.groupFields}}))})}focusInvalidField(){for(const t in this.fields){const i=this.fields[t];if(!i.isValid){setTimeout(()=>i.elem.focus(),0);break}}}afterSubmitValidation(t=!1){this.renderErrors(t),this.globalConfig.focusInvalidField&&this.focusInvalidField()}validate(t=!1){return new Promise(i=>{const s=[];Object.keys(this.fields).forEach(n=>{const l=this.validateField(n);X(l)&&s.push(l)}),Object.keys(this.groupFields).forEach(n=>{const l=this.validateGroup(n);X(l)&&s.push(l)}),Promise.allSettled(s).then(()=>{var n;this.afterSubmitValidation(t),(n=this.onValidateCallback)==null||n.call(this,{isValid:this.isFormValid(),isSubmitted:this.isSubmitted,fields:this.getCompatibleFields(),groups:{...this.groupFields}}),i(!!s.length)})})}revalidate(){return new Promise(t=>{this.validateHandler(void 0,!0).finally(()=>{this.globalConfig.focusInvalidField&&this.focusInvalidField(),t(this.isValid)})})}validateHandler(t,i=!1){return this.globalConfig.lockForm&&this.lockForm(),this.validate(i).finally(()=>{var s,n,l;this.globalConfig.lockForm&&this.unlockForm(),this.isValid?((s=this.onSuccessCallback)==null||s.call(this,t),this.globalConfig.submitFormAutomatically&&((n=t==null?void 0:t.currentTarget)==null||n.submit())):(l=this.onFailCallback)==null||l.call(this,this.getCompatibleFields(),this.groupFields)})}setForm(t){this.form=t,this.form.setAttribute("novalidate","novalidate"),this.removeListener("submit",this.form,this.formSubmitHandler),this.addListener("submit",this.form,this.formSubmitHandler)}addListener(t,i,s){i.addEventListener(t,s),this.eventListeners.push({type:t,elem:i,func:s})}removeListener(t,i,s){i.removeEventListener(t,s),this.eventListeners=this.eventListeners.filter(n=>n.type!==t||n.elem!==i)}addField(t,i,s){if(typeof t!="string"&&!H(t))throw Error("Field selector is not valid. Please specify a string selector or a valid DOM element.");let n;if(typeof t=="string"?n=this.form.querySelector(t):n=t,!n)throw Error("Field doesn't exist in the DOM! Please check the field selector.");if(!Array.isArray(i)||!i.length)throw Error("Rules argument should be an array and should contain at least 1 element.");i.forEach(a=>{if(!("rule"in a||"validator"in a||"plugin"in a))throw Error("Rules argument must contain at least one rule or validator property.");if(!a.validator&&!a.plugin&&(!a.rule||!Object.values(S).includes(a.rule)))throw Error(`Rule should be one of these types: ${Object.values(S).join(", ")}. Provided value: ${a.rule}`)});const l=this.setKeyByFieldSelector(t);return this.fields[l]={elem:n,rules:i,isValid:void 0,touched:!1,config:s},this.setListeners(n),(this.isSubmitted||this.globalConfig.validateBeforeSubmitting)&&this.validateField(l),this}removeField(t){if(typeof t!="string"&&!H(t))throw Error("Field selector is not valid. Please specify a string selector or a valid DOM element.");const i=this.getKeyByFieldSelector(t);if(!i||!this.fields[i])return console.error("Field not found. Check the field selector."),this;const s=this.getListenerType(this.fields[i].elem.type);return this.removeListener(s,this.fields[i].elem,this.handlerChange),this.clearErrors(),delete this.fields[i],this}removeGroup(t){if(typeof t!="string")throw Error("Group selector is not valid. Please specify a string selector.");const i=this.getKeyByFieldSelector(t);return!i||!this.groupFields[i]?(console.error("Group not found. Check the group selector."),this):(this.groupFields[i].elems.forEach(s=>{const n=this.getListenerType(s.type);this.removeListener(n,s,this.handlerChange)}),this.clearErrors(),delete this.groupFields[i],this)}addRequiredGroup(t,i,s,n){if(typeof t!="string"&&!H(t))throw Error("Group selector is not valid. Please specify a string selector or a valid DOM element.");let l;if(typeof t=="string"?l=this.form.querySelector(t):l=t,!l)throw Error("Group selector not found! Please check the group selector.");const a=l.querySelectorAll("input"),h=Array.from(a).filter(v=>{const C=ue(this.groupFields,he(v));return C?C[1].elems.find(I=>I!==v):!0}),w=this.setKeyByFieldSelector(t);return this.groupFields[w]={rules:[{rule:z.Required,errorMessage:i,successMessage:n}],groupElem:l,elems:h,touched:!1,isValid:void 0,config:s},a.forEach(v=>{this.setListeners(v)}),this}getListenerType(t){switch(t){case"checkbox":case"select-one":case"file":case"radio":return"change";default:return"input"}}setListeners(t){const i=this.getListenerType(t.type);this.removeListener(i,t,this.handlerChange),this.addListener(i,t,this.handlerChange)}clearFieldLabel(t){var i,s;(i=this.errorLabels[t])==null||i.remove(),(s=this.successLabels[t])==null||s.remove()}clearFieldStyle(t){var i,s,n,l;const a=this.fields[t],h=((i=a.config)==null?void 0:i.errorFieldStyle)||this.globalConfig.errorFieldStyle;Object.keys(h).forEach(v=>{a.elem.style[v]=""});const w=((s=a.config)==null?void 0:s.successFieldStyle)||this.globalConfig.successFieldStyle||{};Object.keys(w).forEach(v=>{a.elem.style[v]=""}),a.elem.classList.remove(...x(((n=a.config)==null?void 0:n.errorFieldCssClass)||this.globalConfig.errorFieldCssClass),...x(((l=a.config)==null?void 0:l.successFieldCssClass)||this.globalConfig.successFieldCssClass))}clearErrors(){var t,i;Object.keys(this.errorLabels).forEach(s=>this.errorLabels[s].remove()),Object.keys(this.successLabels).forEach(s=>this.successLabels[s].remove());for(const s in this.fields)this.clearFieldStyle(s);for(const s in this.groupFields){const n=this.groupFields[s],l=((t=n.config)==null?void 0:t.errorFieldStyle)||this.globalConfig.errorFieldStyle;Object.keys(l).forEach(h=>{n.elems.forEach(w=>{var v;w.style[h]="",w.classList.remove(...x(((v=n.config)==null?void 0:v.errorFieldCssClass)||this.globalConfig.errorFieldCssClass))})});const a=((i=n.config)==null?void 0:i.successFieldStyle)||this.globalConfig.successFieldStyle||{};Object.keys(a).forEach(h=>{n.elems.forEach(w=>{var v;w.style[h]="",w.classList.remove(...x(((v=n.config)==null?void 0:v.successFieldCssClass)||this.globalConfig.successFieldCssClass))})})}this.tooltips=[]}isTooltip(){return!!this.globalConfig.tooltip}lockForm(){const t=this.form.querySelectorAll("input, textarea, button, select");for(let i=0,s=t.length;i<s;++i)t[i].setAttribute("data-just-validate-fallback-disabled",t[i].disabled?"true":"false"),t[i].setAttribute("disabled","disabled"),t[i].style.pointerEvents="none",t[i].style.webkitFilter="grayscale(100%)",t[i].style.filter="grayscale(100%)"}unlockForm(){const t=this.form.querySelectorAll("input, textarea, button, select");for(let i=0,s=t.length;i<s;++i)t[i].getAttribute("data-just-validate-fallback-disabled")!=="true"&&t[i].removeAttribute("disabled"),t[i].style.pointerEvents="",t[i].style.webkitFilter="",t[i].style.filter=""}renderTooltip(t,i,s){var n;const{top:l,left:a,width:h,height:w}=t.getBoundingClientRect(),v=i.getBoundingClientRect(),C=s||((n=this.globalConfig.tooltip)==null?void 0:n.position);switch(C){case"left":{i.style.top=`${l+w/2-v.height/2}px`,i.style.left=`${a-v.width-j}px`;break}case"top":{i.style.top=`${l-v.height-j}px`,i.style.left=`${a+h/2-v.width/2}px`;break}case"right":{i.style.top=`${l+w/2-v.height/2}px`,i.style.left=`${a+h+j}px`;break}case"bottom":{i.style.top=`${l+w+j}px`,i.style.left=`${a+h/2-v.width/2}px`;break}}return i.dataset.direction=C,{refresh:()=>{this.renderTooltip(t,i,s)}}}createErrorLabelElem(t,i,s){const n=document.createElement("div");n.innerHTML=i;const l=this.isTooltip()?s==null?void 0:s.errorLabelStyle:(s==null?void 0:s.errorLabelStyle)||this.globalConfig.errorLabelStyle;return Object.assign(n.style,l),n.classList.add(...x((s==null?void 0:s.errorLabelCssClass)||this.globalConfig.errorLabelCssClass),"just-validate-error-label"),this.isTooltip()&&(n.dataset.tooltip="true"),this.globalConfig.testingMode&&(n.dataset.testId=`error-label-${t}`),this.errorLabels[t]=n,n}createSuccessLabelElem(t,i,s){if(i===void 0)return null;const n=document.createElement("div");n.innerHTML=i;const l=(s==null?void 0:s.successLabelStyle)||this.globalConfig.successLabelStyle;return Object.assign(n.style,l),n.classList.add(...x((s==null?void 0:s.successLabelCssClass)||this.globalConfig.successLabelCssClass),"just-validate-success-label"),this.globalConfig.testingMode&&(n.dataset.testId=`success-label-${t}`),this.successLabels[t]=n,n}renderErrorsContainer(t,i){const s=i||this.globalConfig.errorsContainer;if(typeof s=="string"){const n=this.form.querySelector(s);if(n)return n.appendChild(t),!0;console.error(`Error container with ${s} selector not found. Errors will be rendered as usual`)}return s instanceof Element?(s.appendChild(t),!0):(s!==void 0&&console.error("Error container not found. It should be a string or existing Element. Errors will be rendered as usual"),!1)}renderGroupLabel(t,i,s,n){!n&&this.renderErrorsContainer(i,s)||t.appendChild(i)}renderFieldLabel(t,i,s,n){var l,a,h,w,v,C,I;if(!(!n&&this.renderErrorsContainer(i,s)))if(t.type==="checkbox"||t.type==="radio"){const y=document.querySelector(`label[for="${t.getAttribute("id")}"]`);((a=(l=t.parentElement)==null?void 0:l.tagName)==null?void 0:a.toLowerCase())==="label"?(w=(h=t.parentElement)==null?void 0:h.parentElement)==null||w.appendChild(i):y?(v=y.parentElement)==null||v.appendChild(i):(C=t.parentElement)==null||C.appendChild(i)}else(I=t.parentElement)==null||I.appendChild(i)}showLabels(t,i){Object.keys(t).forEach((s,n)=>{const l=t[s],a=this.getKeyByFieldSelector(s);if(!a||!this.fields[a]){console.error("Field not found. Check the field selector.");return}const h=this.fields[a];h.isValid=!i,this.clearFieldStyle(a),this.clearFieldLabel(a),this.renderFieldError(a,!1,l),n===0&&this.globalConfig.focusInvalidField&&setTimeout(()=>h.elem.focus(),0)})}showErrors(t){if(typeof t!="object")throw Error("[showErrors]: Errors should be an object with key: value format");this.showLabels(t,!0)}showSuccessLabels(t){if(typeof t!="object")throw Error("[showSuccessLabels]: Labels should be an object with key: value format");this.showLabels(t,!1)}renderFieldError(t,i=!1,s){var n,l,a,h,w,v;const C=this.fields[t];if(C.isValid===!1&&(this.isValid=!1),C.isValid===void 0||!i&&!this.isSubmitted&&!C.touched&&s===void 0)return;if(C.isValid){if(!C.asyncCheckPending){const y=this.createSuccessLabelElem(t,s!==void 0?s:C.successMessage,C.config);y&&this.renderFieldLabel(C.elem,y,(n=C.config)==null?void 0:n.errorsContainer,!0),C.elem.classList.add(...x(((l=C.config)==null?void 0:l.successFieldCssClass)||this.globalConfig.successFieldCssClass))}return}C.elem.classList.add(...x(((a=C.config)==null?void 0:a.errorFieldCssClass)||this.globalConfig.errorFieldCssClass));const I=this.createErrorLabelElem(t,s!==void 0?s:C.errorMessage,C.config);this.renderFieldLabel(C.elem,I,(h=C.config)==null?void 0:h.errorsContainer),this.isTooltip()&&this.tooltips.push(this.renderTooltip(C.elem,I,(v=(w=C.config)==null?void 0:w.tooltip)==null?void 0:v.position))}renderGroupError(t,i=!0){var s,n,l,a;const h=this.groupFields[t];if(h.isValid===!1&&(this.isValid=!1),h.isValid===void 0||!i&&!this.isSubmitted&&!h.touched)return;if(h.isValid){h.elems.forEach(C=>{var I,y;Object.assign(C.style,((I=h.config)==null?void 0:I.successFieldStyle)||this.globalConfig.successFieldStyle),C.classList.add(...x(((y=h.config)==null?void 0:y.successFieldCssClass)||this.globalConfig.successFieldCssClass))});const v=this.createSuccessLabelElem(t,h.successMessage,h.config);v&&this.renderGroupLabel(h.groupElem,v,(s=h.config)==null?void 0:s.errorsContainer,!0);return}this.isValid=!1,h.elems.forEach(v=>{var C,I;Object.assign(v.style,((C=h.config)==null?void 0:C.errorFieldStyle)||this.globalConfig.errorFieldStyle),v.classList.add(...x(((I=h.config)==null?void 0:I.errorFieldCssClass)||this.globalConfig.errorFieldCssClass))});const w=this.createErrorLabelElem(t,h.errorMessage,h.config);this.renderGroupLabel(h.groupElem,w,(n=h.config)==null?void 0:n.errorsContainer),this.isTooltip()&&this.tooltips.push(this.renderTooltip(h.groupElem,w,(a=(l=h.config)==null?void 0:l.tooltip)==null?void 0:a.position))}renderErrors(t=!1){if(!(!this.isSubmitted&&!t&&!this.globalConfig.validateBeforeSubmitting)){this.clearErrors(),this.isValid=!0;for(const i in this.groupFields)this.renderGroupError(i);for(const i in this.fields)this.renderFieldError(i)}}destroy(){this.eventListeners.forEach(t=>{this.removeListener(t.type,t.elem,t.func)}),Object.keys(this.customStyleTags).forEach(t=>{this.customStyleTags[t].remove()}),this.clearErrors(),this.globalConfig.lockForm&&this.unlockForm()}refresh(){this.destroy(),this.form?(this.initialize(this.form,this.globalConfig),Object.keys(this.fields).forEach(t=>{const i=this.getFieldSelectorByKey(t);i&&this.addField(i,[...this.fields[t].rules],this.fields[t].config)})):console.error("Cannot initialize the library! Form is not defined")}setCurrentLocale(t){if(typeof t!="string"&&t!==void 0){console.error("Current locale should be a string");return}this.currentLocale=t,this.isSubmitted&&this.validate()}onSuccess(t){return this.onSuccessCallback=t,this}onFail(t){return this.onFailCallback=t,this}onValidate(t){return this.onValidateCallback=t,this}}var me=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ge(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var Z={};/*!
	By André Rinas, www.andrerinas.de
	Documentation, www.simplelightbox.com
	Available for use under the MIT License
	Version 2.14.3
*/(function(d){Object.defineProperty(d,"__esModule",{value:!0}),d.default=void 0;function t(m){"@babel/helpers - typeof";return t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},t(m)}function i(m,f){var e=typeof Symbol<"u"&&m[Symbol.iterator]||m["@@iterator"];if(!e){if(Array.isArray(m)||(e=l(m))||f){e&&(m=e);var o=0,r=function(){};return{s:r,n:function(){return o>=m.length?{done:!0}:{done:!1,value:m[o++]}},e:function(g){throw g},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var c=!0,u=!1,b;return{s:function(){e=e.call(m)},n:function(){var g=e.next();return c=g.done,g},e:function(g){u=!0,b=g},f:function(){try{!c&&e.return!=null&&e.return()}finally{if(u)throw b}}}}function s(m){return h(m)||a(m)||l(m)||n()}function n(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function l(m,f){if(m){if(typeof m=="string")return w(m,f);var e=Object.prototype.toString.call(m).slice(8,-1);if(e==="Object"&&m.constructor&&(e=m.constructor.name),e==="Map"||e==="Set")return Array.from(m);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return w(m,f)}}function a(m){if(typeof Symbol<"u"&&m[Symbol.iterator]!=null||m["@@iterator"]!=null)return Array.from(m)}function h(m){if(Array.isArray(m))return w(m)}function w(m,f){(f==null||f>m.length)&&(f=m.length);for(var e=0,o=new Array(f);e<f;e++)o[e]=m[e];return o}function v(m,f){if(!(m instanceof f))throw new TypeError("Cannot call a class as a function")}function C(m,f){for(var e=0;e<f.length;e++){var o=f[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(m,o.key,o)}}function I(m,f,e){return f&&C(m.prototype,f),Object.defineProperty(m,"prototype",{writable:!1}),m}function y(m,f,e){return f in m?Object.defineProperty(m,f,{value:e,enumerable:!0,configurable:!0,writable:!0}):m[f]=e,m}var V=function(){function m(f,e){var o=this;if(v(this,m),y(this,"defaultOptions",{sourceAttr:"href",overlay:!0,overlayOpacity:.7,spinner:!0,nav:!0,navText:["&lsaquo;","&rsaquo;"],captions:!0,captionDelay:0,captionSelector:"img",captionType:"attr",captionsData:"title",captionPosition:"bottom",captionClass:"",captionHTML:!0,close:!0,closeText:"&times;",swipeClose:!0,showCounter:!0,fileExt:"png|jpg|jpeg|gif|webp|avif",animationSlide:!0,animationSpeed:250,preloading:!0,enableKeyboard:!0,loop:!0,rel:!1,docClose:!0,swipeTolerance:50,className:"simple-lightbox",widthRatio:.8,heightRatio:.9,scaleImageToRatio:!1,disableRightClick:!1,disableScroll:!0,alertError:!0,alertErrorMessage:"Image not found, next image will be loaded",additionalHtml:!1,history:!0,throttleInterval:0,doubleTapZoom:2,maxZoom:10,htmlClass:"has-lightbox",rtl:!1,fixedClass:"sl-fixed",fadeSpeed:300,uniqueImages:!0,focus:!0,scrollZoom:!0,scrollZoomFactor:.5,download:!1}),y(this,"transitionPrefix",void 0),y(this,"isPassiveEventsSupported",void 0),y(this,"transitionCapable",!1),y(this,"isTouchDevice","ontouchstart"in window),y(this,"isAppleDevice",/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),y(this,"initialLocationHash",void 0),y(this,"pushStateSupport","pushState"in history),y(this,"isOpen",!1),y(this,"isAnimating",!1),y(this,"isClosing",!1),y(this,"isFadeIn",!1),y(this,"urlChangedOnce",!1),y(this,"hashReseted",!1),y(this,"historyHasChanges",!1),y(this,"historyUpdateTimeout",null),y(this,"currentImage",void 0),y(this,"eventNamespace","simplelightbox"),y(this,"domNodes",{}),y(this,"loadedImages",[]),y(this,"initialImageIndex",0),y(this,"currentImageIndex",0),y(this,"initialSelector",null),y(this,"globalScrollbarWidth",0),y(this,"controlCoordinates",{swipeDiff:0,swipeYDiff:0,swipeStart:0,swipeEnd:0,swipeYStart:0,swipeYEnd:0,mousedown:!1,imageLeft:0,zoomed:!1,containerHeight:0,containerWidth:0,containerOffsetX:0,containerOffsetY:0,imgHeight:0,imgWidth:0,capture:!1,initialOffsetX:0,initialOffsetY:0,initialPointerOffsetX:0,initialPointerOffsetY:0,initialPointerOffsetX2:0,initialPointerOffsetY2:0,initialScale:1,initialPinchDistance:0,pointerOffsetX:0,pointerOffsetY:0,pointerOffsetX2:0,pointerOffsetY2:0,targetOffsetX:0,targetOffsetY:0,targetScale:0,pinchOffsetX:0,pinchOffsetY:0,limitOffsetX:0,limitOffsetY:0,scaleDifference:0,targetPinchDistance:0,touchCount:0,doubleTapped:!1,touchmoveCount:0}),this.options=Object.assign(this.defaultOptions,e),this.isPassiveEventsSupported=this.checkPassiveEventsSupport(),typeof f=="string"?(this.initialSelector=f,this.elements=Array.from(document.querySelectorAll(f))):this.elements=typeof f.length<"u"&&f.length>0?Array.from(f):[f],this.relatedElements=[],this.transitionPrefix=this.calculateTransitionPrefix(),this.transitionCapable=this.transitionPrefix!==!1,this.initialLocationHash=this.hash,this.options.rel&&(this.elements=this.getRelated(this.options.rel)),this.options.uniqueImages){var r=[];this.elements=Array.from(this.elements).filter(function(c){var u=c.getAttribute(o.options.sourceAttr);return r.indexOf(u)===-1?(r.push(u),!0):!1})}this.createDomNodes(),this.options.close&&this.domNodes.wrapper.appendChild(this.domNodes.closeButton),this.options.nav&&this.domNodes.wrapper.appendChild(this.domNodes.navigation),this.options.spinner&&this.domNodes.wrapper.appendChild(this.domNodes.spinner),this.addEventListener(this.elements,"click."+this.eventNamespace,function(c){if(o.isValidLink(c.currentTarget)){if(c.preventDefault(),o.isAnimating)return!1;o.initialImageIndex=o.elements.indexOf(c.currentTarget),o.openImage(c.currentTarget)}}),this.options.docClose&&this.addEventListener(this.domNodes.wrapper,["click."+this.eventNamespace,"touchstart."+this.eventNamespace],function(c){o.isOpen&&c.target===c.currentTarget&&o.close()}),this.options.disableRightClick&&this.addEventListener(document.body,"contextmenu."+this.eventNamespace,function(c){c.target.parentElement.classList.contains("sl-image")&&c.preventDefault()}),this.options.enableKeyboard&&this.addEventListener(document.body,"keyup."+this.eventNamespace,this.throttle(function(c){if(o.controlCoordinates.swipeDiff=0,o.isAnimating&&c.key==="Escape"){o.currentImage.setAttribute("src",""),o.isAnimating=!1,o.close();return}o.isOpen&&(c.preventDefault(),c.key==="Escape"&&o.close(),!o.isAnimating&&["ArrowLeft","ArrowRight"].indexOf(c.key)>-1&&o.loadImage(c.key==="ArrowRight"?1:-1))},this.options.throttleInterval)),this.addEvents()}return I(m,[{key:"checkPassiveEventsSupport",value:function(){var e=!1;try{var o=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassive",null,o),window.removeEventListener("testPassive",null,o)}catch{}return e}},{key:"getCaptionElement",value:function(e){if(this.options.captionSelector.startsWith("+")){var o=this.options.captionSelector.replace(/^\+/,"").trimStart(),r=e.nextElementSibling;return r&&r.matches(o)?r:!1}else if(this.options.captionSelector.startsWith(">")){var c=this.options.captionSelector.replace(/^>/,"").trimStart();return e.querySelector(c)}else return e.querySelector(this.options.captionSelector)}},{key:"generateQuerySelector",value:function(e){var o=e.tagName,r=e.id,c=e.className,u=e.parentNode;if(o==="HTML")return"HTML";var b=o;if(b+=r!==""?"#".concat(r):"",c)for(var p=c.trim().split(/\s/),g=0;g<p.length;g++)b+=".".concat(p[g]);for(var E=1,N=e;N.previousElementSibling;N=N.previousElementSibling)E+=1;return b+=":nth-child(".concat(E,")"),"".concat(this.generateQuerySelector(u)," > ").concat(b)}},{key:"createDomNodes",value:function(){if(this.domNodes.overlay=document.createElement("div"),this.domNodes.overlay.classList.add("sl-overlay"),this.domNodes.overlay.dataset.opacityTarget=this.options.overlayOpacity,this.domNodes.closeButton=document.createElement("button"),this.domNodes.closeButton.classList.add("sl-close"),this.domNodes.closeButton.innerHTML=this.options.closeText,this.domNodes.spinner=document.createElement("div"),this.domNodes.spinner.classList.add("sl-spinner"),this.domNodes.spinner.innerHTML="<div></div>",this.domNodes.navigation=document.createElement("div"),this.domNodes.navigation.classList.add("sl-navigation"),this.domNodes.navigation.innerHTML='<button class="sl-prev">'.concat(this.options.navText[0],'</button><button class="sl-next">').concat(this.options.navText[1],"</button>"),this.domNodes.counter=document.createElement("div"),this.domNodes.counter.classList.add("sl-counter"),this.domNodes.counter.innerHTML='<span class="sl-current"></span>/<span class="sl-total"></span>',this.domNodes.download=document.createElement("div"),this.domNodes.download.classList.add("sl-download"),this.domNodes.downloadLink=document.createElement("a"),this.domNodes.downloadLink.setAttribute("download",""),this.domNodes.downloadLink.textContent=this.options.download,this.domNodes.download.appendChild(this.domNodes.downloadLink),this.domNodes.caption=document.createElement("div"),this.domNodes.caption.classList.add("sl-caption","pos-"+this.options.captionPosition),this.options.captionClass){var e,o=this.options.captionClass.split(/[\s,]+/);(e=this.domNodes.caption.classList).add.apply(e,s(o))}this.domNodes.image=document.createElement("div"),this.domNodes.image.classList.add("sl-image"),this.domNodes.wrapper=document.createElement("div"),this.domNodes.wrapper.classList.add("sl-wrapper"),this.domNodes.wrapper.setAttribute("tabindex",-1),this.domNodes.wrapper.setAttribute("role","dialog"),this.domNodes.wrapper.setAttribute("aria-hidden",!1),this.options.className&&this.domNodes.wrapper.classList.add(this.options.className),this.options.rtl&&this.domNodes.wrapper.classList.add("sl-dir-rtl")}},{key:"throttle",value:function(e,o){var r;return function(){r||(e.apply(this,arguments),r=!0,setTimeout(function(){return r=!1},o))}}},{key:"isValidLink",value:function(e){return!this.options.fileExt||e.getAttribute(this.options.sourceAttr)&&new RegExp("("+this.options.fileExt+")($|\\?.*$)","i").test(e.getAttribute(this.options.sourceAttr))}},{key:"calculateTransitionPrefix",value:function(){var e=(document.body||document.documentElement).style;return"transition"in e?"":"WebkitTransition"in e?"-webkit-":"MozTransition"in e?"-moz-":"OTransition"in e?"-o":!1}},{key:"getScrollbarWidth",value:function(){var e=0,o=document.createElement("div");return o.classList.add("sl-scrollbar-measure"),document.body.appendChild(o),e=o.offsetWidth-o.clientWidth,document.body.removeChild(o),e}},{key:"toggleScrollbar",value:function(e){var o=0,r=[].slice.call(document.querySelectorAll("."+this.options.fixedClass));if(e==="hide"){var c=window.innerWidth;if(!c){var u=document.documentElement.getBoundingClientRect();c=u.right-Math.abs(u.left)}if(document.body.clientWidth<c||this.isAppleDevice){var b=parseInt(window.getComputedStyle(document.body).paddingRight||0,10);o=this.getScrollbarWidth(),document.body.dataset.originalPaddingRight=b,(o>0||o==0&&this.isAppleDevice)&&(document.body.classList.add("hidden-scroll"),document.body.style.paddingRight=b+o+"px",r.forEach(function(p){var g=p.style.paddingRight,E=window.getComputedStyle(p)["padding-right"];p.dataset.originalPaddingRight=g,p.style.paddingRight="".concat(parseFloat(E)+o,"px")}))}}else document.body.classList.remove("hidden-scroll"),document.body.style.paddingRight=document.body.dataset.originalPaddingRight+"px",r.forEach(function(p){var g=p.dataset.originalPaddingRight;typeof g<"u"&&(p.style.paddingRight=g)});return o}},{key:"close",value:function(){var e=this;if(!this.isOpen||this.isAnimating||this.isClosing)return!1;this.isClosing=!0;var o=this.relatedElements[this.currentImageIndex];o.dispatchEvent(new Event("close.simplelightbox")),this.options.history&&(this.historyHasChanges=!1,this.hashReseted||this.resetHash()),this.removeEventListener(document,"focusin."+this.eventNamespace),this.fadeOut(this.domNodes.overlay,this.options.fadeSpeed),this.fadeOut(document.querySelectorAll(".sl-image img,  .sl-close, .sl-navigation, .sl-image .sl-caption, .sl-counter"),this.options.fadeSpeed,function(){e.options.disableScroll&&e.toggleScrollbar("show"),e.options.htmlClass&&e.options.htmlClass!==""&&document.querySelector("html").classList.remove(e.options.htmlClass),document.body.removeChild(e.domNodes.wrapper),e.options.overlay&&document.body.removeChild(e.domNodes.overlay),e.domNodes.additionalHtml=null,e.domNodes.download=null,o.dispatchEvent(new Event("closed.simplelightbox")),e.isClosing=!1}),this.currentImage=null,this.isOpen=!1,this.isAnimating=!1;for(var r in this.controlCoordinates)this.controlCoordinates[r]=0;this.controlCoordinates.mousedown=!1,this.controlCoordinates.zoomed=!1,this.controlCoordinates.capture=!1,this.controlCoordinates.initialScale=this.minMax(1,1,this.options.maxZoom),this.controlCoordinates.doubleTapped=!1}},{key:"hash",get:function(){return window.location.hash.substring(1)}},{key:"preload",value:function(){var e=this,o=this.currentImageIndex,r=this.relatedElements.length,c=o+1<0?r-1:o+1>=r-1?0:o+1,u=o-1<0?r-1:o-1>=r-1?0:o-1,b=new Image,p=new Image;b.addEventListener("load",function(g){var E=g.target.getAttribute("src");e.loadedImages.indexOf(E)===-1&&e.loadedImages.push(E),e.relatedElements[o].dispatchEvent(new Event("nextImageLoaded."+e.eventNamespace))}),b.setAttribute("src",this.relatedElements[c].getAttribute(this.options.sourceAttr)),p.addEventListener("load",function(g){var E=g.target.getAttribute("src");e.loadedImages.indexOf(E)===-1&&e.loadedImages.push(E),e.relatedElements[o].dispatchEvent(new Event("prevImageLoaded."+e.eventNamespace))}),p.setAttribute("src",this.relatedElements[u].getAttribute(this.options.sourceAttr))}},{key:"loadImage",value:function(e){var o=this,r=e;this.options.rtl&&(e=-e),this.relatedElements[this.currentImageIndex].dispatchEvent(new Event("change."+this.eventNamespace)),this.relatedElements[this.currentImageIndex].dispatchEvent(new Event((e===1?"next":"prev")+"."+this.eventNamespace));var c=this.currentImageIndex+e;if(this.isAnimating||(c<0||c>=this.relatedElements.length)&&this.options.loop===!1)return!1;this.currentImageIndex=c<0?this.relatedElements.length-1:c>this.relatedElements.length-1?0:c,this.domNodes.counter.querySelector(".sl-current").innerHTML=this.currentImageIndex+1,this.options.animationSlide&&this.slide(this.options.animationSpeed/1e3,-100*r-this.controlCoordinates.swipeDiff+"px"),this.fadeOut(this.domNodes.image,this.options.fadeSpeed,function(){o.isAnimating=!0,o.isClosing?o.isAnimating=!1:setTimeout(function(){var u=o.relatedElements[o.currentImageIndex];o.currentImage&&(o.currentImage.setAttribute("src",u.getAttribute(o.options.sourceAttr)),o.loadedImages.indexOf(u.getAttribute(o.options.sourceAttr))===-1&&o.show(o.domNodes.spinner),o.domNodes.image.contains(o.domNodes.caption)&&o.domNodes.image.removeChild(o.domNodes.caption),o.adjustImage(r),o.options.preloading&&o.preload())},100)})}},{key:"adjustImage",value:function(e){var o=this;if(!this.currentImage)return!1;var r=new Image,c=window.innerWidth*this.options.widthRatio,u=window.innerHeight*this.options.heightRatio;r.setAttribute("src",this.currentImage.getAttribute("src")),this.currentImage.dataset.scale=1,this.currentImage.dataset.translateX=0,this.currentImage.dataset.translateY=0,this.zoomPanElement(0,0,1),r.addEventListener("error",function(b){o.relatedElements[o.currentImageIndex].dispatchEvent(new Event("error."+o.eventNamespace)),o.isAnimating=!1,o.isOpen=!0,o.domNodes.spinner.style.display="none";var p=e===1||e===-1;if(o.initialImageIndex===o.currentImageIndex&&p)return o.close();o.options.alertError&&alert(o.options.alertErrorMessage),o.loadImage(p?e:1)}),r.addEventListener("load",function(b){typeof e<"u"&&(o.relatedElements[o.currentImageIndex].dispatchEvent(new Event("changed."+o.eventNamespace)),o.relatedElements[o.currentImageIndex].dispatchEvent(new Event((e===1?"nextDone":"prevDone")+"."+o.eventNamespace))),o.options.history&&o.updateURL(),o.loadedImages.indexOf(o.currentImage.getAttribute("src"))===-1&&o.loadedImages.push(o.currentImage.getAttribute("src"));var p=b.target.width,g=b.target.height;if(o.options.scaleImageToRatio||p>c||g>u){var E=p/g>c/u?p/c:g/u;p/=E,g/=E}o.domNodes.image.style.top=(window.innerHeight-g)/2+"px",o.domNodes.image.style.left=(window.innerWidth-p-o.globalScrollbarWidth)/2+"px",o.domNodes.image.style.width=p+"px",o.domNodes.image.style.height=g+"px",o.domNodes.spinner.style.display="none",o.options.focus&&o.forceFocus(),o.fadeIn(o.currentImage,o.options.fadeSpeed,function(){o.options.focus&&o.domNodes.wrapper.focus()}),o.isOpen=!0;var N,F;typeof o.options.captionSelector=="string"?N=o.options.captionSelector==="self"?o.relatedElements[o.currentImageIndex]:o.getCaptionElement(o.relatedElements[o.currentImageIndex]):typeof o.options.captionSelector=="function"&&(N=o.options.captionSelector(o.relatedElements[o.currentImageIndex])),o.options.captions&&N&&(o.options.captionType==="data"?F=N.dataset[o.options.captionsData]:o.options.captionType==="text"?F=N.innerHTML:F=N.getAttribute(o.options.captionsData)),o.options.loop?o.relatedElements.length===1?o.hide(o.domNodes.navigation.querySelectorAll(".sl-prev, .sl-next")):o.show(o.domNodes.navigation.querySelectorAll(".sl-prev, .sl-next")):(o.currentImageIndex===0&&o.hide(o.domNodes.navigation.querySelector(".sl-prev")),o.currentImageIndex>=o.relatedElements.length-1&&o.hide(o.domNodes.navigation.querySelector(".sl-next")),o.currentImageIndex>0&&o.show(o.domNodes.navigation.querySelector(".sl-prev")),o.currentImageIndex<o.relatedElements.length-1&&o.show(o.domNodes.navigation.querySelector(".sl-next"))),e===1||e===-1?(o.options.animationSlide&&(o.slide(0,100*e+"px"),setTimeout(function(){o.slide(o.options.animationSpeed/1e3,"0px")},50)),o.fadeIn(o.domNodes.image,o.options.fadeSpeed,function(){o.isAnimating=!1,o.setCaption(F,p)})):(o.isAnimating=!1,o.setCaption(F,p)),o.options.additionalHtml&&!o.domNodes.additionalHtml&&(o.domNodes.additionalHtml=document.createElement("div"),o.domNodes.additionalHtml.classList.add("sl-additional-html"),o.domNodes.additionalHtml.innerHTML=o.options.additionalHtml,o.domNodes.image.appendChild(o.domNodes.additionalHtml)),o.options.download&&o.domNodes.downloadLink.setAttribute("href",o.currentImage.getAttribute("src"))})}},{key:"zoomPanElement",value:function(e,o,r){this.currentImage.style[this.transitionPrefix+"transform"]="translate("+e+","+o+") scale("+r+")"}},{key:"minMax",value:function(e,o,r){return e<o?o:e>r?r:e}},{key:"setZoomData",value:function(e,o,r){this.currentImage.dataset.scale=e,this.currentImage.dataset.translateX=o,this.currentImage.dataset.translateY=r}},{key:"hashchangeHandler",value:function(){this.isOpen&&this.hash===this.initialLocationHash&&(this.hashReseted=!0,this.close())}},{key:"addEvents",value:function(){var e=this;if(this.addEventListener(window,"resize."+this.eventNamespace,function(r){e.isOpen&&e.adjustImage()}),this.addEventListener(this.domNodes.closeButton,["click."+this.eventNamespace,"touchstart."+this.eventNamespace],this.close.bind(this)),this.options.history&&setTimeout(function(){e.addEventListener(window,"hashchange."+e.eventNamespace,function(r){e.isOpen&&e.hashchangeHandler()})},40),this.addEventListener(this.domNodes.navigation.getElementsByTagName("button"),"click."+this.eventNamespace,function(r){if(!r.currentTarget.tagName.match(/button/i))return!0;r.preventDefault(),e.controlCoordinates.swipeDiff=0,e.loadImage(r.currentTarget.classList.contains("sl-next")?1:-1)}),this.options.scrollZoom){var o=1;this.addEventListener(this.domNodes.image,["mousewheel","DOMMouseScroll"],function(r){if(e.controlCoordinates.mousedown||e.isAnimating||e.isClosing||!e.isOpen)return!0;e.controlCoordinates.containerHeight==0&&(e.controlCoordinates.containerHeight=e.getDimensions(e.domNodes.image).height,e.controlCoordinates.containerWidth=e.getDimensions(e.domNodes.image).width,e.controlCoordinates.imgHeight=e.getDimensions(e.currentImage).height,e.controlCoordinates.imgWidth=e.getDimensions(e.currentImage).width,e.controlCoordinates.containerOffsetX=e.domNodes.image.offsetLeft,e.controlCoordinates.containerOffsetY=e.domNodes.image.offsetTop,e.controlCoordinates.initialOffsetX=parseFloat(e.currentImage.dataset.translateX),e.controlCoordinates.initialOffsetY=parseFloat(e.currentImage.dataset.translateY));var c=r.delta||r.wheelDelta;c===void 0&&(c=r.detail),c=Math.max(-1,Math.min(1,c)),o+=c*e.options.scrollZoomFactor*o,o=Math.max(1,Math.min(e.options.maxZoom,o)),e.controlCoordinates.targetScale=o;var u=document.documentElement.scrollTop||document.body.scrollTop;e.controlCoordinates.pinchOffsetX=r.pageX,e.controlCoordinates.pinchOffsetY=r.pageY-u||0,e.controlCoordinates.limitOffsetX=(e.controlCoordinates.imgWidth*e.controlCoordinates.targetScale-e.controlCoordinates.containerWidth)/2,e.controlCoordinates.limitOffsetY=(e.controlCoordinates.imgHeight*e.controlCoordinates.targetScale-e.controlCoordinates.containerHeight)/2,e.controlCoordinates.scaleDifference=e.controlCoordinates.targetScale-e.controlCoordinates.initialScale,e.controlCoordinates.targetOffsetX=e.controlCoordinates.imgWidth*e.controlCoordinates.targetScale<=e.controlCoordinates.containerWidth?0:e.minMax(e.controlCoordinates.initialOffsetX-(e.controlCoordinates.pinchOffsetX-e.controlCoordinates.containerOffsetX-e.controlCoordinates.containerWidth/2-e.controlCoordinates.initialOffsetX)/(e.controlCoordinates.targetScale-e.controlCoordinates.scaleDifference)*e.controlCoordinates.scaleDifference,e.controlCoordinates.limitOffsetX*-1,e.controlCoordinates.limitOffsetX),e.controlCoordinates.targetOffsetY=e.controlCoordinates.imgHeight*e.controlCoordinates.targetScale<=e.controlCoordinates.containerHeight?0:e.minMax(e.controlCoordinates.initialOffsetY-(e.controlCoordinates.pinchOffsetY-e.controlCoordinates.containerOffsetY-e.controlCoordinates.containerHeight/2-e.controlCoordinates.initialOffsetY)/(e.controlCoordinates.targetScale-e.controlCoordinates.scaleDifference)*e.controlCoordinates.scaleDifference,e.controlCoordinates.limitOffsetY*-1,e.controlCoordinates.limitOffsetY),e.zoomPanElement(e.controlCoordinates.targetOffsetX+"px",e.controlCoordinates.targetOffsetY+"px",e.controlCoordinates.targetScale),e.controlCoordinates.targetScale>1?(e.controlCoordinates.zoomed=!0,(!e.domNodes.caption.style.opacity||e.domNodes.caption.style.opacity>0)&&e.domNodes.caption.style.display!=="none"&&e.fadeOut(e.domNodes.caption,e.options.fadeSpeed)):(e.controlCoordinates.initialScale===1&&(e.controlCoordinates.zoomed=!1,e.domNodes.caption.style.display==="none"&&e.fadeIn(e.domNodes.caption,e.options.fadeSpeed)),e.controlCoordinates.initialPinchDistance=null,e.controlCoordinates.capture=!1),e.controlCoordinates.initialPinchDistance=e.controlCoordinates.targetPinchDistance,e.controlCoordinates.initialScale=e.controlCoordinates.targetScale,e.controlCoordinates.initialOffsetX=e.controlCoordinates.targetOffsetX,e.controlCoordinates.initialOffsetY=e.controlCoordinates.targetOffsetY,e.setZoomData(e.controlCoordinates.targetScale,e.controlCoordinates.targetOffsetX,e.controlCoordinates.targetOffsetY),e.zoomPanElement(e.controlCoordinates.targetOffsetX+"px",e.controlCoordinates.targetOffsetY+"px",e.controlCoordinates.targetScale)})}this.addEventListener(this.domNodes.image,["touchstart."+this.eventNamespace,"mousedown."+this.eventNamespace],function(r){if(r.target.tagName==="A"&&r.type==="touchstart")return!0;if(r.type==="mousedown")r.preventDefault(),e.controlCoordinates.initialPointerOffsetX=r.clientX,e.controlCoordinates.initialPointerOffsetY=r.clientY,e.controlCoordinates.containerHeight=e.getDimensions(e.domNodes.image).height,e.controlCoordinates.containerWidth=e.getDimensions(e.domNodes.image).width,e.controlCoordinates.imgHeight=e.getDimensions(e.currentImage).height,e.controlCoordinates.imgWidth=e.getDimensions(e.currentImage).width,e.controlCoordinates.containerOffsetX=e.domNodes.image.offsetLeft,e.controlCoordinates.containerOffsetY=e.domNodes.image.offsetTop,e.controlCoordinates.initialOffsetX=parseFloat(e.currentImage.dataset.translateX),e.controlCoordinates.initialOffsetY=parseFloat(e.currentImage.dataset.translateY),e.controlCoordinates.capture=!0;else{if(e.controlCoordinates.touchCount=r.touches.length,e.controlCoordinates.initialPointerOffsetX=r.touches[0].clientX,e.controlCoordinates.initialPointerOffsetY=r.touches[0].clientY,e.controlCoordinates.containerHeight=e.getDimensions(e.domNodes.image).height,e.controlCoordinates.containerWidth=e.getDimensions(e.domNodes.image).width,e.controlCoordinates.imgHeight=e.getDimensions(e.currentImage).height,e.controlCoordinates.imgWidth=e.getDimensions(e.currentImage).width,e.controlCoordinates.containerOffsetX=e.domNodes.image.offsetLeft,e.controlCoordinates.containerOffsetY=e.domNodes.image.offsetTop,e.controlCoordinates.touchCount===1){if(!e.controlCoordinates.doubleTapped)e.controlCoordinates.doubleTapped=!0,setTimeout(function(){e.controlCoordinates.doubleTapped=!1},300);else return e.currentImage.classList.add("sl-transition"),e.controlCoordinates.zoomed?(e.controlCoordinates.initialScale=1,e.setZoomData(e.controlCoordinates.initialScale,0,0),e.zoomPanElement("0px","0px",e.controlCoordinates.initialScale),e.controlCoordinates.zoomed=!1):(e.controlCoordinates.initialScale=e.options.doubleTapZoom,e.setZoomData(e.controlCoordinates.initialScale,0,0),e.zoomPanElement("0px","0px",e.controlCoordinates.initialScale),(!e.domNodes.caption.style.opacity||e.domNodes.caption.style.opacity>0)&&e.domNodes.caption.style.display!=="none"&&e.fadeOut(e.domNodes.caption,e.options.fadeSpeed),e.controlCoordinates.zoomed=!0),setTimeout(function(){e.currentImage&&e.currentImage.classList.remove("sl-transition")},200),!1;e.controlCoordinates.initialOffsetX=parseFloat(e.currentImage.dataset.translateX),e.controlCoordinates.initialOffsetY=parseFloat(e.currentImage.dataset.translateY)}else e.controlCoordinates.touchCount===2&&(e.controlCoordinates.initialPointerOffsetX2=r.touches[1].clientX,e.controlCoordinates.initialPointerOffsetY2=r.touches[1].clientY,e.controlCoordinates.initialOffsetX=parseFloat(e.currentImage.dataset.translateX),e.controlCoordinates.initialOffsetY=parseFloat(e.currentImage.dataset.translateY),e.controlCoordinates.pinchOffsetX=(e.controlCoordinates.initialPointerOffsetX+e.controlCoordinates.initialPointerOffsetX2)/2,e.controlCoordinates.pinchOffsetY=(e.controlCoordinates.initialPointerOffsetY+e.controlCoordinates.initialPointerOffsetY2)/2,e.controlCoordinates.initialPinchDistance=Math.sqrt((e.controlCoordinates.initialPointerOffsetX-e.controlCoordinates.initialPointerOffsetX2)*(e.controlCoordinates.initialPointerOffsetX-e.controlCoordinates.initialPointerOffsetX2)+(e.controlCoordinates.initialPointerOffsetY-e.controlCoordinates.initialPointerOffsetY2)*(e.controlCoordinates.initialPointerOffsetY-e.controlCoordinates.initialPointerOffsetY2)));e.controlCoordinates.capture=!0}return e.controlCoordinates.mousedown?!0:(e.transitionCapable&&(e.controlCoordinates.imageLeft=parseInt(e.domNodes.image.style.left,10)),e.controlCoordinates.mousedown=!0,e.controlCoordinates.swipeDiff=0,e.controlCoordinates.swipeYDiff=0,e.controlCoordinates.swipeStart=r.pageX||r.touches[0].pageX,e.controlCoordinates.swipeYStart=r.pageY||r.touches[0].pageY,!1)}),this.addEventListener(this.domNodes.image,["touchmove."+this.eventNamespace,"mousemove."+this.eventNamespace,"MSPointerMove"],function(r){if(!e.controlCoordinates.mousedown)return!0;if(r.type==="touchmove"){if(e.controlCoordinates.capture===!1)return!1;e.controlCoordinates.pointerOffsetX=r.touches[0].clientX,e.controlCoordinates.pointerOffsetY=r.touches[0].clientY,e.controlCoordinates.touchCount=r.touches.length,e.controlCoordinates.touchmoveCount++,e.controlCoordinates.touchCount>1?(e.controlCoordinates.pointerOffsetX2=r.touches[1].clientX,e.controlCoordinates.pointerOffsetY2=r.touches[1].clientY,e.controlCoordinates.targetPinchDistance=Math.sqrt((e.controlCoordinates.pointerOffsetX-e.controlCoordinates.pointerOffsetX2)*(e.controlCoordinates.pointerOffsetX-e.controlCoordinates.pointerOffsetX2)+(e.controlCoordinates.pointerOffsetY-e.controlCoordinates.pointerOffsetY2)*(e.controlCoordinates.pointerOffsetY-e.controlCoordinates.pointerOffsetY2)),e.controlCoordinates.initialPinchDistance===null&&(e.controlCoordinates.initialPinchDistance=e.controlCoordinates.targetPinchDistance),Math.abs(e.controlCoordinates.initialPinchDistance-e.controlCoordinates.targetPinchDistance)>=1&&(e.controlCoordinates.targetScale=e.minMax(e.controlCoordinates.targetPinchDistance/e.controlCoordinates.initialPinchDistance*e.controlCoordinates.initialScale,1,e.options.maxZoom),e.controlCoordinates.limitOffsetX=(e.controlCoordinates.imgWidth*e.controlCoordinates.targetScale-e.controlCoordinates.containerWidth)/2,e.controlCoordinates.limitOffsetY=(e.controlCoordinates.imgHeight*e.controlCoordinates.targetScale-e.controlCoordinates.containerHeight)/2,e.controlCoordinates.scaleDifference=e.controlCoordinates.targetScale-e.controlCoordinates.initialScale,e.controlCoordinates.targetOffsetX=e.controlCoordinates.imgWidth*e.controlCoordinates.targetScale<=e.controlCoordinates.containerWidth?0:e.minMax(e.controlCoordinates.initialOffsetX-(e.controlCoordinates.pinchOffsetX-e.controlCoordinates.containerOffsetX-e.controlCoordinates.containerWidth/2-e.controlCoordinates.initialOffsetX)/(e.controlCoordinates.targetScale-e.controlCoordinates.scaleDifference)*e.controlCoordinates.scaleDifference,e.controlCoordinates.limitOffsetX*-1,e.controlCoordinates.limitOffsetX),e.controlCoordinates.targetOffsetY=e.controlCoordinates.imgHeight*e.controlCoordinates.targetScale<=e.controlCoordinates.containerHeight?0:e.minMax(e.controlCoordinates.initialOffsetY-(e.controlCoordinates.pinchOffsetY-e.controlCoordinates.containerOffsetY-e.controlCoordinates.containerHeight/2-e.controlCoordinates.initialOffsetY)/(e.controlCoordinates.targetScale-e.controlCoordinates.scaleDifference)*e.controlCoordinates.scaleDifference,e.controlCoordinates.limitOffsetY*-1,e.controlCoordinates.limitOffsetY),e.zoomPanElement(e.controlCoordinates.targetOffsetX+"px",e.controlCoordinates.targetOffsetY+"px",e.controlCoordinates.targetScale),e.controlCoordinates.targetScale>1&&(e.controlCoordinates.zoomed=!0,(!e.domNodes.caption.style.opacity||e.domNodes.caption.style.opacity>0)&&e.domNodes.caption.style.display!=="none"&&e.fadeOut(e.domNodes.caption,e.options.fadeSpeed)),e.controlCoordinates.initialPinchDistance=e.controlCoordinates.targetPinchDistance,e.controlCoordinates.initialScale=e.controlCoordinates.targetScale,e.controlCoordinates.initialOffsetX=e.controlCoordinates.targetOffsetX,e.controlCoordinates.initialOffsetY=e.controlCoordinates.targetOffsetY)):(e.controlCoordinates.targetScale=e.controlCoordinates.initialScale,e.controlCoordinates.limitOffsetX=(e.controlCoordinates.imgWidth*e.controlCoordinates.targetScale-e.controlCoordinates.containerWidth)/2,e.controlCoordinates.limitOffsetY=(e.controlCoordinates.imgHeight*e.controlCoordinates.targetScale-e.controlCoordinates.containerHeight)/2,e.controlCoordinates.targetOffsetX=e.controlCoordinates.imgWidth*e.controlCoordinates.targetScale<=e.controlCoordinates.containerWidth?0:e.minMax(e.controlCoordinates.pointerOffsetX-(e.controlCoordinates.initialPointerOffsetX-e.controlCoordinates.initialOffsetX),e.controlCoordinates.limitOffsetX*-1,e.controlCoordinates.limitOffsetX),e.controlCoordinates.targetOffsetY=e.controlCoordinates.imgHeight*e.controlCoordinates.targetScale<=e.controlCoordinates.containerHeight?0:e.minMax(e.controlCoordinates.pointerOffsetY-(e.controlCoordinates.initialPointerOffsetY-e.controlCoordinates.initialOffsetY),e.controlCoordinates.limitOffsetY*-1,e.controlCoordinates.limitOffsetY),Math.abs(e.controlCoordinates.targetOffsetX)===Math.abs(e.controlCoordinates.limitOffsetX)&&(e.controlCoordinates.initialOffsetX=e.controlCoordinates.targetOffsetX,e.controlCoordinates.initialPointerOffsetX=e.controlCoordinates.pointerOffsetX),Math.abs(e.controlCoordinates.targetOffsetY)===Math.abs(e.controlCoordinates.limitOffsetY)&&(e.controlCoordinates.initialOffsetY=e.controlCoordinates.targetOffsetY,e.controlCoordinates.initialPointerOffsetY=e.controlCoordinates.pointerOffsetY),e.setZoomData(e.controlCoordinates.initialScale,e.controlCoordinates.targetOffsetX,e.controlCoordinates.targetOffsetY),e.zoomPanElement(e.controlCoordinates.targetOffsetX+"px",e.controlCoordinates.targetOffsetY+"px",e.controlCoordinates.targetScale))}if(r.type==="mousemove"&&e.controlCoordinates.mousedown){if(r.type=="touchmove")return!0;if(r.preventDefault(),e.controlCoordinates.capture===!1)return!1;e.controlCoordinates.pointerOffsetX=r.clientX,e.controlCoordinates.pointerOffsetY=r.clientY,e.controlCoordinates.targetScale=e.controlCoordinates.initialScale,e.controlCoordinates.limitOffsetX=(e.controlCoordinates.imgWidth*e.controlCoordinates.targetScale-e.controlCoordinates.containerWidth)/2,e.controlCoordinates.limitOffsetY=(e.controlCoordinates.imgHeight*e.controlCoordinates.targetScale-e.controlCoordinates.containerHeight)/2,e.controlCoordinates.targetOffsetX=e.controlCoordinates.imgWidth*e.controlCoordinates.targetScale<=e.controlCoordinates.containerWidth?0:e.minMax(e.controlCoordinates.pointerOffsetX-(e.controlCoordinates.initialPointerOffsetX-e.controlCoordinates.initialOffsetX),e.controlCoordinates.limitOffsetX*-1,e.controlCoordinates.limitOffsetX),e.controlCoordinates.targetOffsetY=e.controlCoordinates.imgHeight*e.controlCoordinates.targetScale<=e.controlCoordinates.containerHeight?0:e.minMax(e.controlCoordinates.pointerOffsetY-(e.controlCoordinates.initialPointerOffsetY-e.controlCoordinates.initialOffsetY),e.controlCoordinates.limitOffsetY*-1,e.controlCoordinates.limitOffsetY),Math.abs(e.controlCoordinates.targetOffsetX)===Math.abs(e.controlCoordinates.limitOffsetX)&&(e.controlCoordinates.initialOffsetX=e.controlCoordinates.targetOffsetX,e.controlCoordinates.initialPointerOffsetX=e.controlCoordinates.pointerOffsetX),Math.abs(e.controlCoordinates.targetOffsetY)===Math.abs(e.controlCoordinates.limitOffsetY)&&(e.controlCoordinates.initialOffsetY=e.controlCoordinates.targetOffsetY,e.controlCoordinates.initialPointerOffsetY=e.controlCoordinates.pointerOffsetY),e.setZoomData(e.controlCoordinates.initialScale,e.controlCoordinates.targetOffsetX,e.controlCoordinates.targetOffsetY),e.zoomPanElement(e.controlCoordinates.targetOffsetX+"px",e.controlCoordinates.targetOffsetY+"px",e.controlCoordinates.targetScale)}e.controlCoordinates.zoomed||(e.controlCoordinates.swipeEnd=r.pageX||r.touches[0].pageX,e.controlCoordinates.swipeYEnd=r.pageY||r.touches[0].pageY,e.controlCoordinates.swipeDiff=e.controlCoordinates.swipeStart-e.controlCoordinates.swipeEnd,e.controlCoordinates.swipeYDiff=e.controlCoordinates.swipeYStart-e.controlCoordinates.swipeYEnd,e.options.animationSlide&&e.slide(0,-e.controlCoordinates.swipeDiff+"px"))}),this.addEventListener(this.domNodes.image,["touchend."+this.eventNamespace,"mouseup."+this.eventNamespace,"touchcancel."+this.eventNamespace,"mouseleave."+this.eventNamespace,"pointerup","pointercancel","MSPointerUp","MSPointerCancel"],function(r){if(e.isTouchDevice&&r.type==="touchend"&&(e.controlCoordinates.touchCount=r.touches.length,e.controlCoordinates.touchCount===0?(e.currentImage&&e.setZoomData(e.controlCoordinates.initialScale,e.controlCoordinates.targetOffsetX,e.controlCoordinates.targetOffsetY),e.controlCoordinates.initialScale===1&&(e.controlCoordinates.zoomed=!1,e.domNodes.caption.style.display==="none"&&e.fadeIn(e.domNodes.caption,e.options.fadeSpeed)),e.controlCoordinates.initialPinchDistance=null,e.controlCoordinates.capture=!1):e.controlCoordinates.touchCount===1?(e.controlCoordinates.initialPointerOffsetX=r.touches[0].clientX,e.controlCoordinates.initialPointerOffsetY=r.touches[0].clientY):e.controlCoordinates.touchCount>1&&(e.controlCoordinates.initialPinchDistance=null)),e.controlCoordinates.mousedown){e.controlCoordinates.mousedown=!1;var c=!0;e.options.loop||(e.currentImageIndex===0&&e.controlCoordinates.swipeDiff<0&&(c=!1),e.currentImageIndex>=e.relatedElements.length-1&&e.controlCoordinates.swipeDiff>0&&(c=!1)),Math.abs(e.controlCoordinates.swipeDiff)>e.options.swipeTolerance&&c?e.loadImage(e.controlCoordinates.swipeDiff>0?1:-1):e.options.animationSlide&&e.slide(e.options.animationSpeed/1e3,"0px"),e.options.swipeClose&&Math.abs(e.controlCoordinates.swipeYDiff)>50&&Math.abs(e.controlCoordinates.swipeDiff)<e.options.swipeTolerance&&e.close()}}),this.addEventListener(this.domNodes.image,["dblclick"],function(r){if(!e.isTouchDevice)return e.controlCoordinates.initialPointerOffsetX=r.clientX,e.controlCoordinates.initialPointerOffsetY=r.clientY,e.controlCoordinates.containerHeight=e.getDimensions(e.domNodes.image).height,e.controlCoordinates.containerWidth=e.getDimensions(e.domNodes.image).width,e.controlCoordinates.imgHeight=e.getDimensions(e.currentImage).height,e.controlCoordinates.imgWidth=e.getDimensions(e.currentImage).width,e.controlCoordinates.containerOffsetX=e.domNodes.image.offsetLeft,e.controlCoordinates.containerOffsetY=e.domNodes.image.offsetTop,e.currentImage.classList.add("sl-transition"),e.controlCoordinates.zoomed?(e.controlCoordinates.initialScale=1,e.setZoomData(e.controlCoordinates.initialScale,0,0),e.zoomPanElement("0px","0px",e.controlCoordinates.initialScale),e.controlCoordinates.zoomed=!1,e.domNodes.caption.style.display==="none"&&e.fadeIn(e.domNodes.caption,e.options.fadeSpeed)):(e.controlCoordinates.initialScale=e.options.doubleTapZoom,e.setZoomData(e.controlCoordinates.initialScale,0,0),e.zoomPanElement("0px","0px",e.controlCoordinates.initialScale),(!e.domNodes.caption.style.opacity||e.domNodes.caption.style.opacity>0)&&e.domNodes.caption.style.display!=="none"&&e.fadeOut(e.domNodes.caption,e.options.fadeSpeed),e.controlCoordinates.zoomed=!0),setTimeout(function(){e.currentImage&&(e.currentImage.classList.remove("sl-transition"),e.currentImage.style[e.transitionPrefix+"transform-origin"]=null)},200),e.controlCoordinates.capture=!0,!1})}},{key:"getDimensions",value:function(e){var o=window.getComputedStyle(e),r=e.offsetHeight,c=e.offsetWidth,u=parseFloat(o.borderTopWidth),b=parseFloat(o.borderBottomWidth),p=parseFloat(o.paddingTop),g=parseFloat(o.paddingBottom),E=parseFloat(o.borderLeftWidth),N=parseFloat(o.borderRightWidth),F=parseFloat(o.paddingLeft),L=parseFloat(o.paddingRight);return{height:r-b-u-p-g,width:c-E-N-F-L}}},{key:"updateHash",value:function(){var e="pid="+(this.currentImageIndex+1),o=window.location.href.split("#")[0]+"#"+e;this.hashReseted=!1,this.pushStateSupport?window.history[this.historyHasChanges?"replaceState":"pushState"]("",document.title,o):this.historyHasChanges?window.location.replace(o):window.location.hash=e,this.historyHasChanges||(this.urlChangedOnce=!0),this.historyHasChanges=!0}},{key:"resetHash",value:function(){this.hashReseted=!0,this.urlChangedOnce?history.back():this.pushStateSupport?history.pushState("",document.title,window.location.pathname+window.location.search):window.location.hash="",clearTimeout(this.historyUpdateTimeout)}},{key:"updateURL",value:function(){clearTimeout(this.historyUpdateTimeout),this.historyHasChanges?this.historyUpdateTimeout=setTimeout(this.updateHash.bind(this),800):this.updateHash()}},{key:"setCaption",value:function(e,o,r){var c=this;if(this.options.captions&&e&&e!==""&&typeof e<"u"){var u,b=!((u=r??this.options.captionHTML)!==null&&u!==void 0)||u?"innerHTML":"innerText";this.hide(this.domNodes.caption),this.domNodes.caption.style.width=o+"px",this.domNodes.caption[b]=e,this.domNodes.image.appendChild(this.domNodes.caption),setTimeout(function(){c.fadeIn(c.domNodes.caption,c.options.fadeSpeed)},this.options.captionDelay)}}},{key:"slide",value:function(e,o){if(!this.transitionCapable)return this.domNodes.image.style.left=o;this.domNodes.image.style[this.transitionPrefix+"transform"]="translateX("+o+")",this.domNodes.image.style[this.transitionPrefix+"transition"]=this.transitionPrefix+"transform "+e+"s linear"}},{key:"getRelated",value:function(e){var o;return e&&e!==!1&&e!=="nofollow"?o=Array.from(this.elements).filter(function(r){return r.getAttribute("rel")===e}):o=this.elements,o}},{key:"openImage",value:function(e){var o=this;e.dispatchEvent(new Event("show."+this.eventNamespace)),this.globalScrollbarWidth=this.getScrollbarWidth(),this.options.disableScroll&&(this.toggleScrollbar("hide"),this.globalScrollbarWidth=0),this.options.htmlClass&&this.options.htmlClass!==""&&document.querySelector("html").classList.add(this.options.htmlClass),document.body.appendChild(this.domNodes.wrapper),this.domNodes.wrapper.appendChild(this.domNodes.image),this.options.overlay&&document.body.appendChild(this.domNodes.overlay),this.relatedElements=this.getRelated(e.rel),this.options.showCounter&&(this.relatedElements.length==1&&this.domNodes.wrapper.contains(this.domNodes.counter)?this.domNodes.wrapper.removeChild(this.domNodes.counter):this.relatedElements.length>1&&!this.domNodes.wrapper.contains(this.domNodes.counter)&&this.domNodes.wrapper.appendChild(this.domNodes.counter)),this.options.download&&this.domNodes.download&&this.domNodes.wrapper.appendChild(this.domNodes.download),this.isAnimating=!0,this.currentImageIndex=this.relatedElements.indexOf(e);var r=e.getAttribute(this.options.sourceAttr);this.currentImage=document.createElement("img"),this.currentImage.style.display="none",this.currentImage.setAttribute("src",r),this.currentImage.dataset.scale=1,this.currentImage.dataset.translateX=0,this.currentImage.dataset.translateY=0,this.loadedImages.indexOf(r)===-1&&this.loadedImages.push(r),this.domNodes.image.innerHTML="",this.domNodes.image.setAttribute("style",""),this.domNodes.image.appendChild(this.currentImage),this.fadeIn(this.domNodes.overlay,this.options.fadeSpeed),this.fadeIn([this.domNodes.counter,this.domNodes.navigation,this.domNodes.closeButton,this.domNodes.download],this.options.fadeSpeed),this.show(this.domNodes.spinner),this.domNodes.counter.querySelector(".sl-current").innerHTML=this.currentImageIndex+1,this.domNodes.counter.querySelector(".sl-total").innerHTML=this.relatedElements.length,this.adjustImage(),this.options.preloading&&this.preload(),setTimeout(function(){e.dispatchEvent(new Event("shown."+o.eventNamespace))},this.options.animationSpeed)}},{key:"forceFocus",value:function(){var e=this;this.removeEventListener(document,"focusin."+this.eventNamespace),this.addEventListener(document,"focusin."+this.eventNamespace,function(o){document!==o.target&&e.domNodes.wrapper!==o.target&&!e.domNodes.wrapper.contains(o.target)&&e.domNodes.wrapper.focus()})}},{key:"addEventListener",value:function(e,o,r,c){e=this.wrap(e),o=this.wrap(o);var u=i(e),b;try{for(u.s();!(b=u.n()).done;){var p=b.value;p.namespaces||(p.namespaces={});var g=i(o),E;try{for(g.s();!(E=g.n()).done;){var N=E.value,F=c||!1,L=["touchstart","touchmove","mousewheel","DOMMouseScroll"].indexOf(N.split(".")[0])>=0;L&&this.isPassiveEventsSupported&&(t(F)==="object"?F.passive=!0:F={passive:!0}),p.namespaces[N]=r,p.addEventListener(N.split(".")[0],r,F)}}catch(P){g.e(P)}finally{g.f()}}}catch(P){u.e(P)}finally{u.f()}}},{key:"removeEventListener",value:function(e,o){e=this.wrap(e),o=this.wrap(o);var r=i(e),c;try{for(r.s();!(c=r.n()).done;){var u=c.value,b=i(o),p;try{for(b.s();!(p=b.n()).done;){var g=p.value;u.namespaces&&u.namespaces[g]&&(u.removeEventListener(g.split(".")[0],u.namespaces[g]),delete u.namespaces[g])}}catch(E){b.e(E)}finally{b.f()}}}catch(E){r.e(E)}finally{r.f()}}},{key:"fadeOut",value:function(e,o,r){var c=this;e=this.wrap(e);var u=i(e),b;try{for(u.s();!(b=u.n()).done;){var p=b.value;p.style.opacity=parseFloat(p)||window.getComputedStyle(p).getPropertyValue("opacity")}}catch(N){u.e(N)}finally{u.f()}this.isFadeIn=!1;var g=16.66666/(o||this.options.fadeSpeed),E=function N(){var F=parseFloat(e[0].style.opacity);if((F-=g)<0){var L=i(e),P;try{for(L.s();!(P=L.n()).done;){var k=P.value;k.style.display="none",k.style.opacity=1}}catch(M){L.e(M)}finally{L.f()}r&&r.call(c,e)}else{var Y=i(e),A;try{for(Y.s();!(A=Y.n()).done;){var D=A.value;D.style.opacity=F}}catch(M){Y.e(M)}finally{Y.f()}requestAnimationFrame(N)}};E()}},{key:"fadeIn",value:function(e,o,r,c){var u=this;e=this.wrap(e);var b=i(e),p;try{for(b.s();!(p=b.n()).done;){var g=p.value;g&&(g.style.opacity=0,g.style.display=c||"block")}}catch(L){b.e(L)}finally{b.f()}this.isFadeIn=!0;var E=parseFloat(e[0].dataset.opacityTarget||1),N=16.66666*E/(o||this.options.fadeSpeed),F=function L(){var P=parseFloat(e[0].style.opacity);if((P+=N)>E){var D=i(e),M;try{for(D.s();!(M=D.n()).done;){var q=M.value;q&&(q.style.opacity=E)}}catch(W){D.e(W)}finally{D.f()}r&&r.call(u,e)}else{var k=i(e),Y;try{for(k.s();!(Y=k.n()).done;){var A=Y.value;A&&(A.style.opacity=P)}}catch(W){k.e(W)}finally{k.f()}if(!u.isFadeIn)return;requestAnimationFrame(L)}};F()}},{key:"hide",value:function(e){e=this.wrap(e);var o=i(e),r;try{for(o.s();!(r=o.n()).done;){var c=r.value;c.style.display!="none"&&(c.dataset.initialDisplay=c.style.display),c.style.display="none"}}catch(u){o.e(u)}finally{o.f()}}},{key:"show",value:function(e,o){e=this.wrap(e);var r=i(e),c;try{for(r.s();!(c=r.n()).done;){var u=c.value;u.style.display=u.dataset.initialDisplay||o||"block"}}catch(b){r.e(b)}finally{r.f()}}},{key:"wrap",value:function(e){return typeof e[Symbol.iterator]=="function"&&typeof e!="string"?e:[e]}},{key:"on",value:function(e,o){e=this.wrap(e);var r=i(this.elements),c;try{for(r.s();!(c=r.n()).done;){var u=c.value;u.fullyNamespacedEvents||(u.fullyNamespacedEvents={});var b=i(e),p;try{for(b.s();!(p=b.n()).done;){var g=p.value;u.fullyNamespacedEvents[g]=o,u.addEventListener(g,o)}}catch(E){b.e(E)}finally{b.f()}}}catch(E){r.e(E)}finally{r.f()}return this}},{key:"off",value:function(e){e=this.wrap(e);var o=i(this.elements),r;try{for(o.s();!(r=o.n()).done;){var c=r.value,u=i(e),b;try{for(u.s();!(b=u.n()).done;){var p=b.value;typeof c.fullyNamespacedEvents<"u"&&p in c.fullyNamespacedEvents&&c.removeEventListener(p,c.fullyNamespacedEvents[p])}}catch(g){u.e(g)}finally{u.f()}}}catch(g){o.e(g)}finally{o.f()}return this}},{key:"open",value:function(e){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;e=e||this.elements[0],typeof jQuery<"u"&&e instanceof jQuery&&(e=e.get(0)),o>0&&(e=this.elements[o]),this.initialImageIndex=this.elements.indexOf(e),this.initialImageIndex>-1&&this.openImage(e)}},{key:"openPosition",value:function(e){var o=this.elements[e];this.open(o,e)}},{key:"next",value:function(){this.loadImage(1)}},{key:"prev",value:function(){this.loadImage(-1)}},{key:"getLighboxData",value:function(){return{currentImageIndex:this.currentImageIndex,currentImage:this.currentImage,globalScrollbarWidth:this.globalScrollbarWidth}}},{key:"destroy",value:function(){this.off(["close."+this.eventNamespace,"closed."+this.eventNamespace,"nextImageLoaded."+this.eventNamespace,"prevImageLoaded."+this.eventNamespace,"change."+this.eventNamespace,"nextDone."+this.eventNamespace,"prevDone."+this.eventNamespace,"error."+this.eventNamespace,"changed."+this.eventNamespace,"next."+this.eventNamespace,"prev."+this.eventNamespace,"show."+this.eventNamespace,"shown."+this.eventNamespace]),this.removeEventListener(this.elements,"click."+this.eventNamespace),this.removeEventListener(document,"focusin."+this.eventNamespace),this.removeEventListener(document.body,"contextmenu."+this.eventNamespace),this.removeEventListener(document.body,"keyup."+this.eventNamespace),this.removeEventListener(this.domNodes.navigation.getElementsByTagName("button"),"click."+this.eventNamespace),this.removeEventListener(this.domNodes.closeButton,"click."+this.eventNamespace),this.removeEventListener(window,"resize."+this.eventNamespace),this.removeEventListener(window,"hashchange."+this.eventNamespace),this.close(),this.isOpen&&(document.body.removeChild(this.domNodes.wrapper),document.body.removeChild(this.domNodes.overlay)),this.elements=null}},{key:"refresh",value:function(){if(!this.initialSelector)throw"refreshing only works when you initialize using a selector!";var e=this.options,o=this.initialSelector;return this.destroy(),this.constructor(o,e),this}}]),m}(),_=V;d.default=_,me.SimpleLightbox=V})(Z);const Ce=ge(Z);export{ve as J,Ce as S};
//# sourceMappingURL=vendor-CsRFDLUU.js.map
